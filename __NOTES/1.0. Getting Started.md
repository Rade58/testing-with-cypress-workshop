# Getting started and Anathomy of the tests

<https://github.com/Rade58/cypress-lessons/blob/main/lessons/0.%20Getting%20Started.md>

AND

<https://github.com/Rade58/cypress-lessons/blob/main/lessons/2.%20Anatomy%20of%20a%20Test.md#anatomy-of-a-test>

WE ARE GOING TO WRITE OUR TESTS USING JAVASCRIPT

# LETS MAKE cypress FOLDER (you don't need to do this because when you choose to configure e2e, folders and files are going to be generated)

**ALL THE FOLDERS WERE THERE BECAUSE I DID CHOOSE SKAFFOLD OF THE PROJECT, THE FIRST TIME I RUNNED CYPRESS**

INSIDE cypress FOLDER THERE SHOULD BE FOLDERS INTEGRATION TESTS, FOR THE DATA WE WANT TO USE DURING TESTS, FOLDER FOR THE COMMANDS, AND A FOLDER FOR PLUGINS, FOLDER FOR END TO END TEST

```
ls cypress/{integration,fixtures,support,plugins,e2e}
```

OUR ONLY TYPESCRIPT FILE IS GOING TO BE `cypress/plugins/index.ts`

I MADE THIS FILE EARLIER

```
touch cypress/plugins/index.ts
```

THERE WE DID DEFINE LOGIC FOR RESETING AND SEEDING OUR DATABASE BEFORE RUNNING TESTS

# ADDED SOME DATA FILES (JSON) INSIDE fixtures FOLDER

HERE: `cypress/fixtures`

# I SKAFFOLDED THIS INTEGRATION TEST 

```
touch cypress/integration/01-first-flight.spec.js
```

```js
/// <reference types="cypress" />

describe('Create a New Item', () => {});

```

# LETS NOW OPEN CYPRESS

```
npx cypress open
```

# LETS NOW START END TO END TESTING IN MICROSOFT EDGE (I CHOOSE THAT OPTION)

THE EDGE BROWSER WINDOOW IS GENERATED; THERE I HAVE A DASBOARD FOR END TO END TESTING OF MY APP

I CHOOSE SOME FIRST TEST GENEERATED BY CYPRESS TO RUN; IT'S AN EXAMPLE APP DEPLOYED ON <https://example.cypress.io/>

FOR THE REST INFO CHECK YOUR LESSONS NOTES I LEFT ON THE BEGGINING OF THIS DOC

<https://github.com/Rade58/cypress-lessons/blob/main/lessons/0.%20Getting%20Started.md#running-your-tests>

# I'M NOTICING NOW FEW THINGS; `cypress/integration` FOLDER IS NOT BEING USED ANYMORE

I MADE THIS FOLDER ACCORDING TO SOME PREVIOUS VERSION OF CYPRESS BUT I THINK NOW; THE FOLDER WITH TESTS IS GENERATED BY CYPRES AND THI IS THAT FOLDER:

**`cypress/e2e`**

I WILL MAKE ONE TET HERE TO SEE IF IT IS GOING TO WORK

I THINK I NEED TO PREFIX EXTENSSION WITH `cy` INSTEAD OF `spec`

YES I WAS RIGHT, WHEN I CREATED THIS FILE, IT WAS IMMEDIATELLY REGISTERED INSIDE DASBOARD

# I MADE ONE NEW TEST

```
mkdir cypress/e2e/3-foo
```

```
touch cypress/e2e/3-foo/01-foo.cy.js
```

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	it('goes to the google page', () => {
		cy.visit('https://google.com');
	});
});

```

I CLICKED ON THE TEST IN THE DASBOARD AND IT REALLY WORKED

IFRAME ON THE RIGHT DID REALLY OPENED GOOGLE PAGE

# LETS AGAIN SEE WHAT WE DO HAVE IN OUR DASBOARD

WE FIRST PICK A BROWSER

THEN OUR DASBOARD OPENS

THE LEFT ARE TEST, AND THINGS ARE SELF EVIDENT ON THE FAR LEFT WHERE SOME BUTTUNS ARE

OUR TEST ARE INSIDE `Spec` TAB

YOU CLICK ON TEST AND IT WILL RUN

ON THE RIGHT IS DASBOARD WITH IFRAMED WEBPAGE

## 1. TARGET SIGN NEAR THE ADDRESS BAR

YOU CAN USE IT TO TARGET SELECTORS FROM THE CONTEXT OF YOUR TEST

## 2. YOU CAN ALSO SEE HOW CYPRESS IS DOING THE SLECTION

```js
cy.get(`[data-test="new-todo"]`)
```

## A word on selectors

<https://github.com/Rade58/cypress-lessons/blob/main/lessons/0.%20Getting%20Started.md#a-word-on-selectors>


# ANATHOMY OF THE TESTS

WHEN YOU HOVER OVER THE TEST INSIDE DASBOARD, THERE IS `Open in IDE` BUTTON

I SELECTED VSCode

A TEST FILE IS NOW OPENED IN MY VSCode

**THIS FILE IS OPENED `cypress/e2e/1-getting-started/todo.cy.js`**

CYPRESS USES Mocha AND chi UNDER THE HOOD

YOU HAVE YOUR `describe` AND `it` BLOCKS

THERE ARE ALSO `beforeEach` INSIDE describe, IT RUNS BEFORE EACH TEST INSIDE describe BLOCK

# FINDING DOM NODES

`cy.get`

IT ACTS LIKE `document.querySelector`

**DIFFERENCE BETWENN document.querySelector AND cy.get:**

- `document.querySelector` will return empty collection if it can't find an element on the page

- `cy.get` WILL CONTINUE TRYING GETTING ELEMENTS UNTILL IT IS SUCCESFULL IN FINDING OUT, **OR AGREED UPON TIMEOUT IS GOING TO EXPIRE**

**OFCOURSE THIS IS IMPORTANT FOR CYPRESS BECAUSE SOMETIMES IN OUR APP WE ARE MOUNTING UPON SUCCESSFULL NETWORK REQUEST, OR WE ARE INSERTING SOME ELEMENT DEPENDING ON SOME OTHER THING; IN POINT OF VIEW OF CYPRESS, THE ELEENTS ARE NOT THERE BUT THEY CAN BE IN A FEW MOMENTS**

# TEST CODE LOOKS SYNCHRONOUS BUT IT IS NOT

<https://github.com/Rade58/cypress-lessons/blob/main/lessons/2.%20Anatomy%20of%20a%20Test.md#a-word-on-asynchrony>

>> Cypress runs all of your directions asynchronouslyâ€”allowing it to retry and whatnot, but it saves us from having to use await before every line because we're calling methods on the `cy` object, which is basically queuing our commands and running them in order.

# FINDING ELEMENTS IN A PAGE (TRAVERSING THE DOM)

`cy.get`

`cy.contains`

# `cy.contains`

AS A MATTER OF FACT LETS WRITE OUR FIRST EVER TEST

```
code cypress/integration/01-foo.cy.js
```

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	// WE ARE GOING TO THE PAGE IN OUR PROJECT
	it('goes to the the localhost of our app; on sign in page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-in');
	});

	// HERE YOU GO WE USED HERE AN ATTRIBUTE SELECTOR
	// WE ARE SEARCHING FOR FORM ELEMENT

	// FOR THE FIRST ELEMENT FOUND WE ARE THEN CHECKING IF
	// THAT ELEMENT HAS SOME ATTRIBUTE

	it('form should have method "POST" on it', () => {
		cy.get('[data-test="sign-in-form"]').should('have.attr', 'method', 'post');
	});

	// NOW WE GO TO SOME OOTHER PAGE

	it('goes to the signup page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-up');
	});
});

```


WE CAN NOW START OUR APP

```
yarn dev
```

IF YOU DIDN'T START CYPRESS YOU CAN DO IT

```
npx cypress open
```

I FOUND OUR TEST IN A DASBOARD AND IT PASSED

AS YOU CAN SEE I DID USE ATTRIBUTE SELECTOR (**FOR SPECIFIC ATTRIBUTE `data-test=`**) AND YOU SHOULD DO THAT, IT IS GOOD PRACTICE, I ALREADY EPLAINED WHY

BUT I COULD USE OTHER SELECTORS TOO, FOR EXAMPLE IF WE ARE CHECKING IF THERE IS SOME AMOUNT ON NESTED ELEMENTS INSIDE SOME LEMENT OR IF THERE ARE NESTED ELEMENTS AT ALL

YOU CAN USE ALL VALID CSS SELECTORS

LET'S USE contains NOW

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	it('goes to the the localhost of our app; on sign in page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-in');
	});

	it('form should have method "POST" on it', () => {
		cy.get('[data-test="sign-in-form"]').should('have.attr', 'method', 'post');
	});

	it('goes to the signup page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-up');
	});

	// HERE YOU GO

	it('form has label with text: "Password"', () => {
		cy.get('form label:nth-of-type(2)').contains('Password');
	});
});

```

SEE THE DASBOARD AND YOU WILL SE THAT TEST HAVE PASSED; YOU CAN CHANGE VALUE AND SEE THAT THAT YOUR ASSERTION FAILED 

**WE DID USE `contains` ABOVE, BUT THAT WASN'T `cy.contains` METHOD**

# `cy.contains`

YOU CAN START SELECTING BY JUST "TELLING" INNER TEXT OF SOME TAG

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	it('goes to the the localhost of our app; on sign in page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-in');
	});

	it('form should have method "POST" on it', () => {
		cy.get('[data-test="sign-in-form"]').should('have.attr', 'method', 'post');
	});

	it('goes to the signup page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-up');
	});

	it('form has label with text: "Password"', () => {
		cy.get('form label:nth-of-type(2)').contains('Password');
	});

	// HERE YOU GO, IT IS PRETTY MUCH AMAZING WHAT SEMANTICS YOU CAN USE

	it('parent of the element that has nested text: "Email Addresa" should have attribute "method"', () => {
		cy.contains('Email Address').parent().should('have.attr', 'method');
	});
});
```

## WHEN YOU FIND N ELEMENT YOU CAN FOR EXAMPLE, CHAIN `find`; YOU CAN ALSO CHAIN METHODS LIKE `focus` OR `check` OR `click` OR `trigger` OR `type`(for typing into an input)

I HAD PROBLEMS WHERE on:change OR on:input DIDN'T HAPPEN WHEN USING `check()` OR `trigger("change")` DIDN'T RESULT OF HANDLERS EXECUTING, WHICH WAS STRANGE SINCE MANUALLY EVERYTHING WORKED; **SO I DECIDED TO SHOW YOU ONLY click**

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	it('goes to the the localhost of our app; on sign in page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-in');
	});

	it('form should have method "POST" on it', () => {
		cy.get('[data-test="sign-in-form"]').should('have.attr', 'method', 'post');
	});

	it('goes to the signup page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-up');
	});

	it('form has label with text: "Password"', () => {
		cy.get('form label:nth-of-type(2)').contains('Password');
	});

	it('parent of the element that has nested text: "Email Addresa" should have attribute "method"', () => {
		cy.contains('Email Address').parent().should('have.attr', 'method');
	});

	it('go to dog-pooper page', () => {
		cy.visit('http://localhost:3000/crypto-pooper');
	});

	// LETS CHECK USE find AND ALSO USR check

	it('Type some text to create new coin, ant coin to be added to the list', () => {
		// THIS DIDN'T WORK (EVEN ON THE SCREEN I SAW
		// CHECMARK GOING INTO CHECKBOX AND GOING OUT)
		// BUT AS I SAID, OPERATION I ATICIPATED DIDN'T HAPPENED TO THIS
		// EVENT HANFDLERS WERENT EXECUTED
		cy.contains('Legit Coins').parent().find('label').last().trigger('click');

		// THIS WORK

		cy.contains('Coin').click().type('Quant');

		cy.get('button[type="submit"]#add-coin').click();
	});
});

```

# I ALREADY SHOWED YOU HOW TO MAKE AN ASSERTIONS WITH USAGE OF `should()`

```js
/// <reference types="cypress" />

describe('Foo test', () => {
	it('goes to the the localhost of our app; on sign in page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-in');
	});

	it('form should have method "POST" on it', () => {
		cy.get('[data-test="sign-in-form"]').should('have.attr', 'method', 'post');
	});

	it('goes to the signup page', () => {
		cy.visit('http://localhost:3000/echo-chamber/sign-up');
	});

	it('form has label with text: "Password"', () => {
		cy.get('form label:nth-of-type(2)').contains('Password');
	});

	it('parent of the element that has nested text: "Email Addresa" should have attribute "method"', () => {
		cy.contains('Email Address').parent().should('have.attr', 'method');
	});

	it('go to dog-pooper page', () => {
		cy.visit('http://localhost:3000/crypto-pooper');
	});

	// LETS CHECK USE find AND ALSO USR check

	it('Type some text to create new coin, ant coin to be added to the list', () => {
		// still not working
		cy.contains('Legit Coins').parent().find('label').last().trigger('click');

		cy.contains('Coin').click().type('Quant');

		cy.get('button[type="submit"]#add-coin').click();

		// ASSERTION
		cy.contains('Legit Coins').parent().find('label').last().should('have.html', 'Quant');
	});
});

```

